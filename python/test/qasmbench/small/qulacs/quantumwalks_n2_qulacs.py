import numpy as np
from qulacs import QuantumCircuit, QuantumState

def func(st, circ):
#    nqubits=2
    #st = QuantumState(nqubits, use_multi_cpu=True)  // for mpiQulacs
#    st = QuantumState(nqubits)                                                             # qreg q1[2];
#    circ = QuantumCircuit(nqubits)


    circ.add_U3_gate(0, 1.5705854245991118, -3.1667235621803993, -1.58730875641222e-05)    # u3(1.5705854245991118,-3.1667235621803993,-1.58730875641222e-05) q1[0];
    circ.add_U3_gate(1, 0.7864502280785407, 1.4997452219669574, 0.050219564359156976)      # u3(0.7864502280785407,1.4997452219669574,0.050219564359156976) q1[1];
    circ.add_CNOT_gate(0, 1)                                                               # cx q1[0],q1[1];
    circ.add_U3_gate(0, 0.050224804187928476, -3.3306690738754696e-15, 3.1415926535897967) # u3(0.050224804187928476,-3.3306690738754696e-15,3.1415926535897967) q1[0];
    circ.add_U3_gate(1, 1.6418473665068425, -1.5707963267948966, 3.141592653589794)        # u3(1.6418473665068425,-1.5707963267948966,3.141592653589794) q1[1];
    circ.add_CNOT_gate(0, 1)                                                               # cx q1[0],q1[1];
    circ.add_U3_gate(0, 1.4956790561350626e-05, 1.5707963268001452, 3.1415926535845444)    # u3(1.4956790561350626e-05,1.5707963268001452,3.1415926535845444) q1[0];
    circ.add_U3_gate(1, 1.5707963267948966, 1.5707963267948968, 3.141592653589793)         # u3(1.5707963267948966,1.5707963267948968,3.141592653589793) q1[1];
    circ.add_CNOT_gate(0, 1)                                                               # cx q1[0],q1[1];
    circ.add_U3_gate(0, 1.5705854245991133, -3.1416085266773286, -0.02513090859065059)     # u3(1.5705854245991133,-3.1416085266773286,-0.02513090859065059) q1[0];
    circ.add_U3_gate(1, 2.3547213646862812, 3.091394193838764, -0.07102121943155337)       # u3(2.3547213646862812,3.091394193838764,-0.07102121943155337) q1[1];
    circ.update_quantum_state(st)
#    with open('Qulacs.log', 'w') as f:
#        print(np.around(st.get_vector(),14)+0, file=f)
